<!DOCTYPE html>
<html>

<% var title = 'list' %>
<% include head %>

<body>
  <div class="container">
    <%- include("./header.ejs") %>
    <h3>用户列表：</h3>
    <table class="table table-bordered table-striped">
      <tr>
        <th>Id</th>
        <th>姓名</th>
        <th>爱好</th>
        <th>操作</th>
      </tr>
      <%for (var i=0;i<accounts.length;i++){%>
        <tr>
          <td><%=accounts[i].id%></td>
          <td><%=accounts[i].name%></td>
          <td><%=accounts[i].like%></td>
          <td>
            <a class="put" href="/user/<%=accounts[i].id%>">修改</a>
            <a class="delete" data-id="/user/<%=accounts[i].id%>?_method=delete">删除</a>
          </td>
        </tr>
      <%}%>
    </table>
    <a href="/user">添加</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="/add-ajax">ajax添加</a>
    <%- include("./footer.ejs") %>
  </div>
  <script>
    $(".delete").on("click",function(){
      var $this = $(this);
      $.ajax({
        url: $this.attr("data-id"),
        type: 'POST',
        success: function(data){
          if(data.result){
            window.location.href="/list";
          } else {
            alert("Error");
          }
        },
        error: function(){
          alert("Other Error");
        }
      });
    });
  </script>
</body>

</html>